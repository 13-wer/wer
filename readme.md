# Оглавление

1. [Команда](#команда)
2. [Описание датасета](#описание-датасета)
3. [Методы подготовки данных](#методы-подготовки-данных)
4. [Варианты построения модели](#варианты-построения-модели)
5. [План по тестированию и валидации построенных моделей](#план-по-тестированию-и-валидации-построенных-моделей)
6. [Промежуточные результаты](#промежуточные-результаты)



## Команда<a id="команда"></a>

| Команда | Зона ответственности | 
|-----------------------------------|------------------| 
| Смирнов Артем Александрович | EDA | 
| Кубракова Екатерина Александровна | составление плана валидации модели |
| Лилиом Елизавета Юрьевна | построение, дообучение классификатора на rubert-base-cased | 
| Ильиных Александр Александрович | создание новых свойств | 
| Гриценко Андрей Дмитриевич | построение, дообучение классификатора на rubert-base-cased-conversational | 
| Антонов Эдуард Кузьмич | построение, дообучение классификатора на rubert-tiny2 |

## Описание датасета<a id="описание-датасета"></a>

Датасет состоит из **6508 наблюдений** и **четырех столбцов**: `model_annotation`, `human_markup`, `audio_path` и `label`.

- Столбец `model_annotation` содержит результаты работы ASR-модели, строки с распознанным голосом.
- Столбец `human_markup` содержит результаты разметки, выполненной человеком (расшифровка аудиозаписей).
- Столбец `audio_path` содержит пути к файлам с аудиозаписями в формате `.wav`.
- Столбец `label` содержит метки целевого класса.

В датасете есть один дубликат (строки с индексами **1953** и **1954**), пропущенные значения **отсутствуют**.

Присутствует незначительный дисбаланс классов:
- **60%** наблюдений имеют метки положительного класса (0),
- **40%** - отрицательного (1).


| Длина фразы в словах для каждого класса |                     |                     |                     |                     |
|------------------------------------------|---------------------|---------------------|---------------------|---------------------|
|                                          | model_annotation    | model_annotation        | human_markup    | human_markup        |
|                                          | 0                   | 1                   | 0                   | 1                   |
| медианная                                | 6                   | 5                   | 6                   | 6                   |
| средняя                                  | 7.73                | 5.99                | 8.14                | 7.45                |
| минимальная                              | 1                   | 1                   | 1                   | 1                   |
| максимальная                             | 62                  | 40                  | 61                  | 60                  |
| стандартное отклонение                   | 5.58                | 4.18                | 6.01                | 5.13                |

Средняя длина слова различается незначительно:
- **4.82** символа у разметки, выполненной моделью,
- **4.73** символа у разметки, выполненной человеком.

Пороговое значение WER для классификации составляет **0.43** (с округлением до сотых).

Низшие показатели метрики получаются при попытке модели распознать речь на иностранном языке как речь на русском языке.

## Методы подготовки данных<a id="методы-подготовки-данных"></a>
Создание новых свойств по первоначальным wav файлам.  Для внесения в оценочную модель.
Дополнительные свойства которые будут созданы: 
- Наличие шума, посторонних звуков, да/нет  вычисление отношения сигнал/шум (Signal-to-Noise Ratio, SNR).
- Темп/скорость речи, как то численное значение получить. Библиотека librosa в Python, для анализа временных рамок и выделения ритмических паттернов.
- Количество слов в фразе.
- Наличие акцента/дефектов речи у говорящего. API Yandex SpeechKit.
- Язык (русский/иностранный). API Yandex SpeechKit.

## Варианты построения модели<a id="варианты-построения-модели"></a>

1. Классические модели машинного обучения:
- Логистическая регрессия
- Случайный лес
- Метод опорных векторов
- Градиентный бустинг

2. Модели на основе предобученных языковых моделей:
- [DeepPavlov/rubert-base-cased](https://huggingface.co/DeepPavlov/rubert-base-cased)
- [DeepPavlov/rubert-base-cased-conversational](https://huggingface.co/DeepPavlov/rubert-base-cased-conversational)
- [cointegrated/rubert-tiny2](https://huggingface.co/cointegrated/rubert-tiny2)

## План по тестированию и валидации построенных моделей<a id="план-по-тестированию-и-валидации-построенных-моделей"></a>
1. Метрики оценки качества:
- Точность (Accuracy) - доля правильно классифицированных образцов.
- Полнота (Recall) - доля релевантных образцов, которые были правильно классифицированы. 
- Точность (Precision) - доля образцов, которые были классифицированы правильно, из всех образцов, отнесенных к данному классу.
- F1-мера - гармоническое среднее между точностью и полнотой.
- ROC-AUC - площадь под кривой ложноположительных и истинноположительных срабатываний.
С построением classic report и визуализацией.

2. Способы улучшения метрик:
- Увеличение размера обучающей выборки – за счет апсэмплинга (в случае необходимости).
- Улучшение предобработки данных - очистка, нормализация, векторизация текста.
- Подбор оптимальных гиперпараметров модели - архитектура, размер эмбеддингов, скорость обучения и т.д.
- Использование техник регуляризации - дропаут, L1/L2 регуляризация, ранняя остановка.
- Применение методов борьбы с переобучением - кросс-валидация.
- Анализ ошибок классификации и доработка моделей. Выбор модели, показавшей оптимальный результат.

3. Процесс валидации:
- Разделение исходных данных на обучающую, валидационную и тестовую выборки.
- Обучение модели на обучающей выборке.
- Оценка качества на валидационной выборке, подбор оптимальных гиперпараметров.
- Оценка финальной производительности на независимой тестовой выборке.
- Документирование результатов, анализ ошибок и направлений для дальнейшей доработки.

## Промежуточные результаты<a id="промежуточные-результаты"></a>

| Модель                           | AUC-ROC | Ноутбук                                                                                                       |
|-----------------------------------|---------|----------------------------------------------------------------------------------------------------------------|
| rubert-base-cased                | 0.77    | [DeepPavlov.ipynb](notebooks/DeepPavlov.ipynb)                                                                |
| rubert-base-cased-conversational | 0.82    | [rubert-base-cased-conversational.ipynb](notebooks/rubert-base-cased-conversational.ipynb)                    |
| rubert-tiny2                      | 0.73    | [tiny_bert.ipynb](notebooks/tiny_bert.ipynb)                                                                  |
